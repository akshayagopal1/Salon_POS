import{_ as F,Q as w,R as m,S as l,V as N,W as U,X as R,U as x,$ as h,Z as u,a6 as v,u as i,ac as y,ae as b,aa as g,D as O,r as V,a8 as S,bc as $,ba as C}from"./index-W9TX4JPH.js";import{g as E,a as A,_ as T}from"./Pos-DZFo8QfI.js";class z{constructor(){this.listeners={},this.failed=!1}on(s,e){this.listeners[s]=this.listeners[s]||[],this.listeners[s].push(e)}trigger(s,e){(this.listeners[s]||[]).forEach(n=>{n.call(this,e)})}upload(s,e){return new Promise((p,n)=>{let a=new XMLHttpRequest;a.upload.addEventListener("loadstart",()=>{this.trigger("start")}),a.upload.addEventListener("progress",d=>{d.lengthComputable&&this.trigger("progress",{uploaded:d.loaded,total:d.total})}),a.upload.addEventListener("load",()=>{this.trigger("finish")}),a.addEventListener("error",()=>{this.trigger("error"),n()}),a.onreadystatechange=()=>{if(a.readyState==XMLHttpRequest.DONE){let d;if(a.status===200){let f=null;try{f=JSON.parse(a.responseText)}catch{f=a.responseText}let _=f.message||f;p(_)}else if(a.status===403)d=JSON.parse(a.responseText);else{this.failed=!0;try{d=JSON.parse(a.responseText)}catch{}}d&&d.exc&&console.error(JSON.parse(d.exc)[0]),n(d)}};const t=e.upload_endpoint||"/api/method/upload_file";a.open("POST",t,!0),a.setRequestHeader("Accept","application/json"),window.csrf_token&&window.csrf_token!=="{{ csrf_token }}"&&a.setRequestHeader("X-Frappe-CSRF-Token",window.csrf_token);let o=new FormData;s&&o.append("file",s,s.name),o.append("is_private",e.private?"1":"0"),o.append("folder",e.folder||"Home"),e.file_url&&o.append("file_url",e.file_url),e.doctype&&o.append("doctype",e.doctype),e.docname&&o.append("docname",e.docname),e.fieldname&&o.append("fieldname",e.fieldname),e.method&&o.append("method",e.method),e.type&&o.append("type",e.type),e.optimize&&(o.append("optimize","1"),e.max_width&&o.append("max_width",e.max_width.toString()),e.max_height&&o.append("max_height",e.max_height.toString())),a.send(o)})}}const L={name:"FileUploader",props:{fileTypes:{type:[String,Array]},uploadArgs:{type:Object},validateFile:{type:Function,default:null}},data(){return{uploader:null,uploading:!1,uploaded:0,error:null,message:"",total:0,file:null,finishedUploading:!1}},computed:{progress(){let r=Math.floor(this.uploaded/this.total*100);return isNaN(r)?0:r},success(){return this.finishedUploading&&!this.error}},methods:{inputRef(){return this.$refs.input},openFileSelector(){this.$refs.input.click()},async onFileAdd(r){if(this.error=null,this.file=r.target.files[0],this.file&&this.validateFile)try{let s=await this.validateFile(this.file);s&&(this.error=s)}catch(s){this.error=s}this.error||this.uploadFile(this.file)},async uploadFile(r){this.error=null,this.uploaded=0,this.total=0,this.uploader=new z,this.uploader.on("start",()=>{this.uploading=!0}),this.uploader.on("progress",s=>{this.uploaded=s.uploaded,this.total=s.total}),this.uploader.on("error",()=>{this.uploading=!1,this.error="Error Uploading File"}),this.uploader.on("finish",()=>{this.uploading=!1,this.finishedUploading=!0}),this.uploader.upload(r,this.uploadArgs||{}).then(s=>{this.$emit("success",s)}).catch(s=>{this.uploading=!1;let e="Error Uploading File";s!=null&&s._server_messages?e=JSON.parse(JSON.parse(s._server_messages)[0]).message:s!=null&&s.exc&&(e=JSON.parse(s.exc)[0].split(`
`).slice(-2,-1)[0]),this.error=e,this.$emit("failure",s)})}},expose:["inputRef"]},P=["accept"];function j(r,s,e,p,n,a){return m(),w("div",null,[l("input",{ref:"input",type:"file",accept:e.fileTypes,class:"hidden",onChange:s[0]||(s[0]=(...t)=>a.onFileAdd&&a.onFileAdd(...t))},null,40,P),N(r.$slots,"default",U(R({file:n.file,uploading:n.uploading,progress:a.progress,uploaded:n.uploaded,message:n.message,error:n.error,total:n.total,success:a.success,openFileSelector:a.openFileSelector})))])}const J=F(L,[["render",j]]),B={class:"flex items-end space-x-1"},k={__name:"ImageUploader",props:{image_url:String,image_type:{type:String,default:"image/*"},label:{type:String,default:""}},emits:["upload","remove"],setup(r,{emit:s}){return(e,p)=>(m(),x(i(J),{"file-types":r.image_type,class:"text-base",onSuccess:p[1]||(p[1]=n=>{e.$emit("upload",n.file_url)})},{default:h(({progress:n,uploading:a,openFileSelector:t})=>[l("div",B,[u(i(y),{onClick:t},{default:h(()=>[b(g(a?`Uploading ${n}%`:r.image_url?"Change":"Upload"),1)]),_:2},1032,["onClick"]),r.image_url?(m(),x(i(y),{key:0,onClick:p[0]||(p[0]=o=>e.$emit("remove"))},{default:h(()=>p[2]||(p[2]=[b("Remove",-1)])),_:1,__:[2]})):v("",!0)])]),_:1},8,["file-types"]))}},H={class:"flex h-[calc(100vh_-_8rem)]"},D={class:"flex flex-col p-2 w-52 shrink-0 bg-surface-gray-2"},G={class:"flex flex-col gap-2 mt-3 hover:cursor-pointer"},q={class:"flex items-center gap-2 hover:bg-surface-gray-3 px-2 py-1 rounded-md"},M={class:"flex h-full flex-col gap-8 p-8 text-ink-gray-9"},X={class:"flex gap-2 text-xl font-semibold leading-none h-5"},I={key:0,class:"flex-1 flex flex-col gap-8 overflow-y-auto"},Q={class:"flex w-full"},W={class:"flex flex-col justify-between gap-4"},Z={class:"flex flex-1 gap-5"},K={class:"flex items-center justify-center rounded border border-outline-gray-modals px-10 py-2"},Y=["src"],ee={class:"flex flex-1 flex-col gap-2"},se={class:"flex flex-col justify-between gap-4"},te={class:"flex flex-1 gap-5"},le={class:"flex items-center justify-center rounded border border-outline-gray-modals px-10 py-2"},ae=["src"],ie={class:"flex flex-1 flex-col gap-2"},oe={class:"flex justify-between flex-row-reverse"},de={__name:"Settings",setup(r){O("base");const s=V(!0),{setting:e,setupBrand:p}=E();function n(){e.save.submit(null,{onSuccess:()=>{p()}})}return(a,t)=>(m(),x(i(C),{options:{size:"6xl"},modelValue:s.value,"onUpdate:modelValue":t[6]||(t[6]=o=>s.value=o),class:"my-custom-dialog-height"},{"body-main":h(()=>{var o,d,f,_;return[l("div",H,[l("div",D,[t[8]||(t[8]=l("h1",{class:"px-2 pt-2 mb-3 text-lg font-semibold text-ink-gray-9"},g("Settings"),-1)),l("ul",G,[l("li",q,[u(i(S),{name:"settings",class:"w-4 h-4 text-ink-gray-9"}),t[7]||(t[7]=l("h1",{class:""},g("General"),-1))])])]),l("div",M,[l("h2",X,[t[9]||(t[9]=b(g("General")+" ",-1)),i(e).isDirty?(m(),x(i(A),{key:0,label:"Not Saved",variant:"subtle",theme:"orange"})):v("",!0)]),i(e).doc?(m(),w("div",I,[l("div",Q,[u(i(T),{type:"text",class:"w-1/2",modelValue:i(e).doc.brand_name,"onUpdate:modelValue":t[0]||(t[0]=c=>i(e).doc.brand_name=c),label:"Brand Name"},null,8,["modelValue"])]),l("div",W,[t[11]||(t[11]=l("span",{class:"text-base font-semibold text-ink-gray-9"},g("Logo"),-1)),l("div",Z,[l("div",K,[l("img",{src:((o=i(e).doc)==null?void 0:o.brand_logo)||"/assets/ant_pos/antPOS.png",alt:"Logo",class:"size-8 rounded"},null,8,Y)]),l("div",ee,[u(k,{label:"Favicon",image_type:"image/ico",image_url:(d=i(e).doc)==null?void 0:d.brand_logo,onUpload:t[1]||(t[1]=c=>i(e).doc.brand_logo=c),onRemove:t[2]||(t[2]=()=>i(e).doc.brand_logo="")},null,8,["image_url"]),t[10]||(t[10]=l("span",{class:"text-p-sm text-ink-gray-6"}," Appears in the left sidebar. Recommended size is 32x32 px in PNG or SVG' ",-1))])])]),l("div",se,[t[13]||(t[13]=l("span",{class:"text-base font-semibold text-ink-gray-9"},g("Favicon"),-1)),l("div",te,[l("div",le,[l("img",{src:((f=i(e).doc)==null?void 0:f.favicon)||"/assets/ant_pos/antPOS.png",alt:"Favicon",class:"size-8 rounded"},null,8,ae)]),l("div",ie,[u(k,{label:"Favicon",image_type:"image/ico",image_url:(_=i(e).doc)==null?void 0:_.favicon,onUpload:t[3]||(t[3]=c=>i(e).doc.favicon=c),onRemove:t[4]||(t[4]=()=>i(e).doc.favicon="")},null,8,["image_url"]),t[12]||(t[12]=l("span",{class:"text-p-sm text-ink-gray-6"}," Appears next to the title in your browser tab. Recommended size is 32x32 px in PNG or ICO', ",-1))])])])])):v("",!0),l("div",oe,[u(i(y),{variant:"solid",label:"Update",onClick:n}),u(i($),{message:i(e).save.error},null,8,["message"])])]),l("div",null,[u(i(y),{variant:"ghost",class:"absolute top-4 right-4",onClick:t[5]||(t[5]=c=>s.value=!1)},{default:h(()=>[u(i(S),{name:"x",class:"w-5 h-5 text-ink-gray-9"})]),_:1})])])]}),_:1},8,["modelValue"]))}};export{de as default};
//# sourceMappingURL=Settings-D_40_l9z.js.map
