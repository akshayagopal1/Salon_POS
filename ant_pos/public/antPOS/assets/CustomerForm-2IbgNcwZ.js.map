{"version":3,"file":"CustomerForm-2IbgNcwZ.js","sources":["../../../../AntPos/src/component/Dialog/CustomerForm.vue"],"sourcesContent":["<template>\n  <Dialog :options=\"{ size: '2xl' }\" v-model=\"dialogVisible\" @close=\"handleDialogClose\" @after-leave=\"handleDialogClose\">\n    <template #body-title>\n      <h3>Create Customer</h3>\n    </template>\n\n    <template #body-content>\n      <div class=\"grid grid-cols-2 gap-5 w-full place-items-stretch\">\n        <FormControl\n          type=\"text\"\n          label=\"Customer Name\"\n          v-model=\"customer.customer_name\"\n          placeholder=\"Enter Customer Name\"\n          size=\"sm\"\n        />\n        <FormControl\n          type=\"text\"\n          label=\"Mobile Number\"\n          v-model=\"customer.mobile_no\"\n          placeholder=\"Enter Mobile Number\"\n          size=\"sm\"\n        />\n        <FormControl\n          type=\"email\"\n          label=\"Email ID\"\n          v-model=\"customer.email_id\"\n          placeholder=\"Enter Email ID\"\n          size=\"sm\"\n        />\n        <FormControl\n          type=\"autocomplete\"\n          label=\"Gender\"\n          v-model=\"customer.gender\"\n          :options=\"genderOptions\"\n          placeholder=\"Select Gender\"\n          size=\"sm\"\n        />\n        <FormControl\n          type=\"autocomplete\"\n          label=\"Customer Group\"\n          v-model=\"customer.customer_group\"\n          :options=\"customerGroupsOptions\"\n          placeholder=\"Select Customer Group\"\n          size=\"sm\"\n        />\n        <FormControl\n          type=\"autocomplete\"\n          label=\"Territory\"\n          v-model=\"customer.territory\"\n          :options=\"territoryOptions\"\n          placeholder=\"Select Territory\"\n          size=\"sm\"\n        />\n      </div>\n    </template>\n\n    <template #actions>\n      <Button variant=\"solid\" @click=\"createCustomer.fetch({})\">Submit</Button>\n      <Button class=\"ml-2\" @click=\"handleDialogClose\">Close</Button>\n    </template>\n  </Dialog>\n</template>\n\n<script setup>\nimport { ref, computed, inject } from 'vue';\nimport { Dialog, createListResource, Button, FormControl, createResource } from 'frappe-ui';\nimport emitter from '../../utils/emitter';\n\nconst dialogVisible = ref(true);\nconst base = inject('base');\n\nconst customer = ref({\n  customer_name: '',\n  mobile_no: '',\n  email_id: '',\n  gender: '',\n  customer_type: 'Individual',\n  customer_group: \"\",\n  territory: '',\n  posa_referral_company: base.pos_profile.company,\n  gst_category: \"Unregistered\",\n});\n\nconst genderOptionsResource = createListResource({\n  doctype: 'Gender',\n  fields: ['name'],\n  pageLength: 10,\n  auto: true,\n  transform: (data) => data.map((item) => item.name),\n});\n\nconst territoryOptionsResource = createListResource({\n  doctype: 'Territory',\n  fields: ['name'],\n  filters: { is_group: 0 },\n  pageLength: 5000,\n  orderBy: 'name',\n  auto: true,\n  transform: (data) => data.map((item) => item.name),\n});\n\nconst customerGroups = createListResource({\n  doctype: 'Customer Group',\n  fields: ['name'],\n  filters: { is_group: 0 },\n  pageLength: 1000,\n  orderBy: 'name',\n  auto: true,\n  transform: (data) => data.map((item) => item.name),\n});\n\nconst genderOptions = computed(() => genderOptionsResource.data || []);\nconst customerGroupsOptions = computed(() => customerGroups.data || []);\nconst territoryOptions = computed(() => territoryOptionsResource.data || []);\n\nconst handleDialogClose = () => {\n  dialogVisible.value = false;\n};\n\nconst createCustomer =  createResource ({\n    method: 'POST',\n    url: 'frappe.client.insert',\n    makeParams() {\n      return {\n        doc: {\n          doctype: 'Customer',\n          ...customer.value,\n          gender: customer.value.gender?.value ?? null,\n          customer_group: customer.value.customer_group?.value ?? null,\n          territory: customer.value.territory?.value ?? null,\n        },\n      };\n    },\n    onSuccess(data) {\n      emitter.emit(\"customerCreated\",data);\n      handleDialogClose();\n    },\n    onError(err) {\n      console.error('Error:', err);\n    },\n  });\n  \n</script>\n"],"names":["dialogVisible","ref","base","inject","customer","genderOptionsResource","createListResource","data","item","territoryOptionsResource","customerGroups","genderOptions","computed","customerGroupsOptions","territoryOptions","handleDialogClose","createCustomer","createResource","_a","_b","_c","emitter","err","_createBlock","_unref","Dialog","$event","_cache","_createElementVNode","_hoisted_1","_createVNode","FormControl","Button"],"mappings":"2RAoEA,MAAMA,EAAgBC,EAAI,EAAI,EACxBC,EAAOC,EAAO,MAAM,EAEpBC,EAAWH,EAAI,CACnB,cAAe,GACf,UAAW,GACX,SAAU,GACV,OAAQ,GACR,cAAe,aACf,eAAgB,GAChB,UAAW,GACX,sBAAuBC,EAAK,YAAY,QACxC,aAAc,cAChB,CAAC,EAEKG,EAAwBC,EAAmB,CAC/C,QAAS,SACT,OAAQ,CAAC,MAAM,EACf,WAAY,GACZ,KAAM,GACN,UAAYC,GAASA,EAAK,IAAKC,GAASA,EAAK,IAAI,CACnD,CAAC,EAEKC,EAA2BH,EAAmB,CAClD,QAAS,YACT,OAAQ,CAAC,MAAM,EACf,QAAS,CAAE,SAAU,CAAC,EACtB,WAAY,IACZ,QAAS,OACT,KAAM,GACN,UAAYC,GAASA,EAAK,IAAKC,GAASA,EAAK,IAAI,CACnD,CAAC,EAEKE,EAAiBJ,EAAmB,CACxC,QAAS,iBACT,OAAQ,CAAC,MAAM,EACf,QAAS,CAAE,SAAU,CAAC,EACtB,WAAY,IACZ,QAAS,OACT,KAAM,GACN,UAAYC,GAASA,EAAK,IAAKC,GAASA,EAAK,IAAI,CACnD,CAAC,EAEKG,EAAgBC,EAAS,IAAMP,EAAsB,MAAQ,CAAA,CAAE,EAC/DQ,EAAwBD,EAAS,IAAMF,EAAe,MAAQ,CAAA,CAAE,EAChEI,EAAmBF,EAAS,IAAMH,EAAyB,MAAQ,CAAA,CAAE,EAErEM,EAAoB,IAAM,CAC9Bf,EAAc,MAAQ,EACxB,EAEMgB,EAAkBC,EAAgB,CACpC,OAAQ,OACR,IAAK,uBACL,YAAa,WACX,MAAO,CACL,IAAK,CACH,QAAS,WACT,GAAGb,EAAS,MACZ,SAAQc,EAAAd,EAAS,MAAM,SAAf,YAAAc,EAAuB,QAAS,KACxC,iBAAgBC,EAAAf,EAAS,MAAM,iBAAf,YAAAe,EAA+B,QAAS,KACxD,YAAWC,EAAAhB,EAAS,MAAM,YAAf,YAAAgB,EAA0B,QAAS,IACxD,CACA,CACI,EACA,UAAUb,EAAM,CACdc,EAAQ,KAAK,kBAAkBd,CAAI,EACnCQ,EAAiB,CACnB,EACA,QAAQO,EAAK,CACX,QAAQ,MAAM,SAAUA,CAAG,CAC7B,CACJ,CAAG,oBA3IDC,EA2DSC,EAAAC,CAAA,EAAA,CA3DA,QAAS,CAAA,KAAA,KAAA,aAA0BzB,EAAA,2CAAAA,EAAa,MAAA0B,GAAG,QAAOX,EAAoB,aAAaA,IACvF,eACT,IAAwBY,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAAxBC,EAAwB,UAApB,kBAAe,EAAA,KAGV,iBACT,IA8CM,CA9CNA,EA8CM,MA9CNC,EA8CM,CA7CJC,EAMEN,EAAAO,CAAA,EAAA,CALA,KAAK,OACL,MAAM,gBACG,WAAA3B,EAAA,MAAS,cAAT,sBAAAuB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAD,GAAAtB,EAAA,MAAS,cAAasB,GAC/B,YAAY,sBACZ,KAAK,6BAEPI,EAMEN,EAAAO,CAAA,EAAA,CALA,KAAK,OACL,MAAM,gBACG,WAAA3B,EAAA,MAAS,UAAT,sBAAAuB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAD,GAAAtB,EAAA,MAAS,UAASsB,GAC3B,YAAY,sBACZ,KAAK,6BAEPI,EAMEN,EAAAO,CAAA,EAAA,CALA,KAAK,QACL,MAAM,WACG,WAAA3B,EAAA,MAAS,SAAT,sBAAAuB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAD,GAAAtB,EAAA,MAAS,SAAQsB,GAC1B,YAAY,iBACZ,KAAK,6BAEPI,EAOEN,EAAAO,CAAA,EAAA,CANA,KAAK,eACL,MAAM,SACG,WAAA3B,EAAA,MAAS,OAAT,sBAAAuB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAD,GAAAtB,EAAA,MAAS,OAAMsB,GACvB,QAASf,EAAA,MACV,YAAY,gBACZ,KAAK,uCAEPmB,EAOEN,EAAAO,CAAA,EAAA,CANA,KAAK,eACL,MAAM,iBACG,WAAA3B,EAAA,MAAS,eAAT,sBAAAuB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAD,GAAAtB,EAAA,MAAS,eAAcsB,GAC/B,QAASb,EAAA,MACV,YAAY,wBACZ,KAAK,uCAEPiB,EAOEN,EAAAO,CAAA,EAAA,CANA,KAAK,eACL,MAAM,YACG,WAAA3B,EAAA,MAAS,UAAT,sBAAAuB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAD,GAAAtB,EAAA,MAAS,UAASsB,GAC1B,QAASZ,EAAA,MACV,YAAY,mBACZ,KAAK,2CAKA,UACT,IAAyE,CAAzEgB,EAAyEN,EAAAQ,CAAA,EAAA,CAAjE,QAAQ,QAAS,QAAKL,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAD,GAAEF,EAAAR,CAAA,EAAe,MAAK,CAAA,CAAA,eAAM,IAAMW,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAN,SAAM,EAAA,kBAChEG,EAA8DN,EAAAQ,CAAA,EAAA,CAAtD,MAAM,OAAQ,QAAOjB,cAAmB,IAAKY,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAA,GAAL,QAAK,EAAA"}